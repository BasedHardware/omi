---
description: "How to use Agent Review effectively to catch bugs before merging"
alwaysApply: false
references:
  - https://cursor.com/docs/agent/review
---

# Agent Review

Agent Review runs Cursor Agent in a specialized mode focused on catching bugs in your diffs. Use it to analyze proposed changes and flag issues before merging.

## When to Use Agent Review

**Use Agent Review when:**
- Agent has generated code changes
- You have local changes to review
- Before creating a PR
- After significant refactoring
- When you want a second opinion on code

**Agent Review catches:**
- Logic bugs and edge cases
- Security vulnerabilities
- Architecture violations
- Missing error handling
- Test coverage gaps
- Performance issues

## Review Workflows

### Review Agent-Generated Code

**In agent diff:**
1. After agent response, click **Review**
2. Click **Find Issues** to analyze edits
3. Review flagged issues
4. Address critical issues
5. Accept changes when satisfied

### Review All Local Changes

**In Source Control:**
1. Open Source Control tab
2. Run Agent Review on all changes
3. Review issues across all files
4. Fix issues before committing

## Review Interface

### File-by-File Review

**Floating review bar:**
- **Accept** or **Reject** changes for current file
- Navigate to **next file** with pending changes
- Review systematically through all files

### Selective Acceptance

**Fine-grained control:**
- Accept most changes: Reject unwanted lines, then **Accept all**
- Reject most changes: Accept wanted lines, then **Reject all**
- Line-by-line review for critical files

## Review Settings

**Auto-run on commit:**
- Enable to scan code automatically after each commit
- Catches issues before pushing

**Include submodules:**
- Include changes from Git submodules in review

**Include untracked files:**
- Include untracked files (not yet added to Git)

## Best Practices

### Before Review

1. **Complete your changes**: Finish implementation first
2. **Run tests**: Ensure tests pass
3. **Format code**: Use `/format` command
4. **Review yourself**: Quick manual review first

### During Review

1. **Address critical issues first**: Fix blocking bugs
2. **Review suggestions carefully**: Not all suggestions are correct
3. **Test fixes**: Verify fixes don't break functionality
4. **Use selective acceptance**: Keep good changes, fix issues

### After Review

1. **Re-run tests**: Ensure fixes don't break tests
2. **Re-review if needed**: Run review again after fixes
3. **Create PR**: Use `/auto-pr` after review passes

## Integration with Bugbot

**Bugbot vs Agent Review:**
- **Bugbot**: Automatic PR reviews (runs on PRs)
- **Agent Review**: Manual review of local changes (before PR)

**Workflow:**
1. Use Agent Review locally
2. Create PR
3. Bugbot reviews PR automatically
4. Address any additional issues

## Omi-Specific Review Checks

### Backend Review

**Check for:**
- Import hierarchy violations
- Missing error handling
- Memory leaks (large objects not freed)
- Database query patterns
- API endpoint documentation

### Flutter Review

**Check for:**
- Hardcoded strings (should use l10n)
- Missing dispose() calls
- BLE resource cleanup
- Platform-specific code isolation

### Cross-Component Review

**Check for:**
- API contract changes
- Breaking changes
- Documentation updates needed
- Test coverage

## Related Resources

### Rules
- `.cursor/rules/common-mistakes.mdc` - Common mistakes to avoid
- `.cursor/rules/verification.mdc` - Verification practices
- `.cursor/BUGBOT.md` - Bugbot review rules

### Commands
- `/code-review` - Manual code review
- `/review-changes` - Review workflow
- `/security-audit` - Security-focused review

### Skills
- `.cursor/skills/agent-review/` - Review workflows
- `.cursor/skills/pr-automation/` - PR automation

### Documentation
- [Cursor Agent Review Docs](https://cursor.com/docs/agent/review)