# Firebase Configuration Guide

This document provides detailed instructions for configuring Firebase in the Omi app.

## Overview

The Omi app uses Firebase for authentication, cloud messaging, and other services. The app supports two methods for Firebase configuration:

1. **Environment Variables (Recommended)**: Secure and flexible approach
2. **Hardcoded Configuration (Fallback)**: Used as a fallback if environment variables are not set

## Environment Variables Configuration

### Step 1: Create a Firebase Project

1. Go to the [Firebase Console](https://console.firebase.google.com/)
2. Click "Add project" and follow the setup wizard
3. Enable the services you need (Authentication, Cloud Messaging, etc.)

### Step 2: Register Your App

1. In your Firebase project, click the gear icon (⚙️) and select "Project settings"
2. In the "Your apps" section, click the platform icon (Android/iOS) to register your app
3. Follow the setup instructions for each platform
4. Download the configuration files (`google-services.json` for Android, `GoogleService-Info.plist` for iOS)

### Step 3: Update Environment Variables

Update your `.dev.env` file with the Firebase configuration values:

```
# Firebase Configuration
FIREBASE_ANDROID_API_KEY=your_android_api_key
FIREBASE_ANDROID_APP_ID=your_android_app_id
FIREBASE_IOS_API_KEY=your_ios_api_key
FIREBASE_IOS_APP_ID=your_ios_app_id
FIREBASE_MESSAGING_SENDER_ID=your_messaging_sender_id
FIREBASE_PROJECT_ID=your_project_id
FIREBASE_STORAGE_BUCKET=your_storage_bucket
FIREBASE_ANDROID_CLIENT_ID=your_android_client_id
FIREBASE_IOS_CLIENT_ID=your_ios_client_id
FIREBASE_IOS_BUNDLE_ID=your_ios_bundle_id
```

You can find these values in:
- The Firebase console under Project settings > Your apps
- The downloaded configuration files (`google-services.json` and `GoogleService-Info.plist`)

### Step 4: Generate Environment Files

Run the build_runner to generate the necessary files:

```bash
dart run build_runner build
```

## Hardcoded Configuration (Fallback)

The app maintains hardcoded Firebase configurations as a fallback mechanism:

- `lib/firebase_options_dev.dart` for development
- `lib/firebase_options_prod.dart` for production

These files are generated by the FlutterFire CLI and should not be edited manually.

## Switching Between Firebase Projects

To switch between different Firebase projects (e.g., development and production):

1. Update the environment variables in the appropriate `.env` file
2. Run the build_runner to regenerate the environment files
3. The app will automatically use the correct Firebase project based on the flavor

## Using FlutterFire CLI

For advanced configuration, you can use the FlutterFire CLI:

1. Install the FlutterFire CLI:
   ```bash
   dart pub global activate flutterfire_cli
   ```

2. Configure Firebase for your app:
   ```bash
   flutterfire configure \
     --platforms="android,ios" \
     --out=lib/firebase_options_dev.dart \
     --ios-bundle-id=your_ios_bundle_id \
     --android-package-name=your_android_package_name \
     --project=your_firebase_project_id
   ```

## Troubleshooting

### Environment Variables Not Working

If the app is not using your environment variables:

1. Verify that all required variables are set in the `.env` file
2. Run `dart run build_runner build` to regenerate the environment files
3. Check the console logs for any errors during Firebase initialization

### Firebase Authentication Issues

If you're experiencing authentication issues:

1. Verify that Authentication is enabled in the Firebase console
2. Check that the correct sign-in methods are enabled
3. For Android, verify that the SHA-1 fingerprint is correctly added to your Firebase project
4. For iOS, verify that the bundle ID matches the one in your Firebase project

## Security Considerations

- Never commit your `.env` files to version control
- Use environment variables for sensitive information
- Consider using different Firebase projects for development and production
- Regularly rotate API keys and update your environment variables