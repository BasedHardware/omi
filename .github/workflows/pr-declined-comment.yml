name: PR Declined Comment

on:
  pull_request_target:
    types: [closed]

jobs:
  comment-on-declined-pr:
    # Only run if PR was closed WITHOUT being merged
    if: github.event.pull_request.merged == false
    runs-on: ubuntu-latest
    
    permissions:
      pull-requests: write
    
    steps:
      - name: Post friendly comment on declined PR
        uses: actions/github-script@v7
        with:
          script: |
            const prAuthor = context.payload.pull_request.user.login;
            const prNumber = context.payload.pull_request.number;
            
            const comment = [
              "Hey @" + prAuthor + " ðŸ‘‹",
              "",
              "Thank you so much for taking the time to contribute to Omi! We truly appreciate you putting in the effort to submit this pull request.",
              "",
              "After careful review, we've decided not to merge this particular PR. Please don't take this personally â€” we genuinely try to merge as many contributions as possible, but sometimes we have to make tough calls based on:",
              "",
              "- **Project standards** â€” Ensuring consistency across the codebase",
              "- **User needs** â€” Making sure changes align with what our users need",
              "- **Code best practices** â€” Maintaining code quality and maintainability",
              "- **Project direction** â€” Keeping aligned with our roadmap and vision",
              "",
              "Your contribution is still valuable to us, and we'd love to see you contribute again in the future! If you'd like feedback on how to improve this PR or want to discuss alternative approaches, please don't hesitate to reach out.",
              "",
              "Thank you for being part of the Omi community! ðŸ’œ"
            ].join("\n");

            await github.rest.issues.createComment({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: prNumber,
              body: comment
            });
            
            console.log("Posted comment on PR #" + prNumber + " by @" + prAuthor);
